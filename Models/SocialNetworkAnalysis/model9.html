<pre><font color="#007f69">patches-own</font><font color="#000000"> [<br />  chemical             </font><font color="#5a5a5a">;; amount of chemical on this patch</font><font color="#000000"><br />  food                 </font><font color="#5a5a5a">;; amount of food on this patch (0, 1, or 2)</font><font color="#000000"><br />  nest?                </font><font color="#5a5a5a">;; true on nest patches, false elsewhere</font><font color="#000000"><br />  nest-scent           </font><font color="#5a5a5a">;; number that is higher closer to the nest</font><font color="#000000"><br />  food-source-number   </font><font color="#5a5a5a">;; number (1, 2, or 3) to identify the food sources</font><font color="#000000"><br />]<br /><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#5a5a5a">;;; Setup procedures ;;;</font><font color="#000000"><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> setup<br />  </font><font color="#0000aa">clear-all</font><font color="#000000"><br />  </font><font color="#0000aa">set-default-shape</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"> </font><font color="#963700">&quot;bug&quot;</font><font color="#000000"><br />  </font><font color="#0000aa">create-turtles</font><font color="#000000"> population<br />  [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">size</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">         </font><font color="#5a5a5a">;; easier to see</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000">  ]   </font><font color="#5a5a5a">;; red = not carrying food</font><font color="#000000"><br />  setup-patches<br />  </font><font color="#0000aa">reset-ticks</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> setup-patches<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br />  [ setup-nest<br />    setup-food<br />    recolor-patch ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> setup-nest  </font><font color="#5a5a5a">;; patch procedure</font><font color="#000000"><br />  </font><font color="#5a5a5a">;; set nest? variable to true inside the nest, false elsewhere</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> nest? (</font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000"><br />  </font><font color="#5a5a5a">;; spread a nest-scent over the whole world -- stronger near the nest</font><font color="#000000"><br />  </font><font color="#0000aa">set</font><font color="#000000"> nest-scent </font><font color="#963700">200</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> </font><font color="#660096">distancexy</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> setup-food  </font><font color="#5a5a5a">;; patch procedure</font><font color="#000000"><br />  </font><font color="#5a5a5a">;; setup food source one on the right</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">distancexy</font><font color="#000000"> (</font><font color="#963700">0.6</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">max-pxcor</font><font color="#000000">) </font><font color="#963700">0</font><font color="#000000">) </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000"><br />  [ </font><font color="#0000aa">set</font><font color="#000000"> food-source-number </font><font color="#963700">1</font><font color="#000000"> ]<br />  </font><font color="#5a5a5a">;; setup food source two on the lower-left</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">distancexy</font><font color="#000000"> (</font><font color="#963700">-0.6</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">max-pxcor</font><font color="#000000">) (</font><font color="#963700">-0.6</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">max-pycor</font><font color="#000000">)) </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000"><br />  [ </font><font color="#0000aa">set</font><font color="#000000"> food-source-number </font><font color="#963700">2</font><font color="#000000"> ]<br />  </font><font color="#5a5a5a">;; setup food source three on the upper-left</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> (</font><font color="#660096">distancexy</font><font color="#000000"> (</font><font color="#963700">-0.8</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">max-pxcor</font><font color="#000000">) (</font><font color="#963700">0.8</font><font color="#000000"> </font><font color="#660096">*</font><font color="#000000"> </font><font color="#660096">max-pycor</font><font color="#000000">)) </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000"><br />  [ </font><font color="#0000aa">set</font><font color="#000000"> food-source-number </font><font color="#963700">3</font><font color="#000000"> ]<br />  </font><font color="#5a5a5a">;; set &quot;food&quot; at sources to either 1 or 2, randomly</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> food-source-number </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"><br />  [ </font><font color="#0000aa">set</font><font color="#000000"> food </font><font color="#660096">one-of</font><font color="#000000"> [</font><font color="#963700">1</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">] ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> recolor-patch  </font><font color="#5a5a5a">;; patch procedure</font><font color="#000000"><br />  </font><font color="#5a5a5a">;; give color to nest and food sources</font><font color="#000000"><br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> nest?<br />  [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">violet</font><font color="#000000"> ]<br />  [ </font><font color="#0000aa">ifelse</font><font color="#000000"> food </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"><br />    [ </font><font color="#0000aa">if</font><font color="#000000"> food-source-number </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">cyan</font><font color="#000000"> ]<br />      </font><font color="#0000aa">if</font><font color="#000000"> food-source-number </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">sky</font><font color="#000000">  ]<br />      </font><font color="#0000aa">if</font><font color="#000000"> food-source-number </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">3</font><font color="#000000"> [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#963700">blue</font><font color="#000000"> ] ]<br />    </font><font color="#5a5a5a">;; scale color to show chemical concentration</font><font color="#000000"><br />    [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">pcolor</font><font color="#000000"> </font><font color="#660096">scale-color</font><font color="#000000"> </font><font color="#963700">green</font><font color="#000000"> chemical </font><font color="#963700">0.1</font><font color="#000000"> </font><font color="#963700">5</font><font color="#000000"> ] ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /></font><font color="#5a5a5a">;;; Go procedures ;;;</font><font color="#000000"><br /></font><font color="#5a5a5a">;;;;;;;;;;;;;;;;;;;;;</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> go  </font><font color="#5a5a5a">;; forever button</font><font color="#000000"><br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">turtles</font><font color="#000000"><br />  [ </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">who</font><font color="#000000"> </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#660096">ticks</font><font color="#000000"> [ </font><font color="#0000aa">stop</font><font color="#000000"> ] </font><font color="#5a5a5a">;; delay initial departure</font><font color="#000000"><br />    </font><font color="#0000aa">ifelse</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000"><br />    [ look-for-food  ]       </font><font color="#5a5a5a">;; not carrying food? look for it</font><font color="#000000"><br />    [ return-to-nest ]       </font><font color="#5a5a5a">;; carrying food? take it back to nest</font><font color="#000000"><br />    wiggle<br />    </font><font color="#0000aa">fd</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> ]<br />  </font><font color="#0000aa">diffuse</font><font color="#000000"> chemical (diffusion-rate </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">)<br />  </font><font color="#0000aa">ask</font><font color="#000000"> </font><font color="#660096">patches</font><font color="#000000"><br />  [ </font><font color="#0000aa">set</font><font color="#000000"> chemical chemical </font><font color="#660096">*</font><font color="#000000"> (</font><font color="#963700">100</font><font color="#000000"> </font><font color="#660096">-</font><font color="#000000"> evaporation-rate) </font><font color="#660096">/</font><font color="#000000"> </font><font color="#963700">100</font><font color="#000000">  </font><font color="#5a5a5a">;; slowly evaporate chemical</font><font color="#000000"><br />    recolor-patch ]<br />  </font><font color="#0000aa">tick</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> return-to-nest  </font><font color="#5a5a5a">;; turtle procedure</font><font color="#000000"><br />  </font><font color="#0000aa">ifelse</font><font color="#000000"> nest?<br />  [ </font><font color="#5a5a5a">;; drop food and head out again</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">red</font><font color="#000000"><br />    </font><font color="#0000aa">rt</font><font color="#000000"> </font><font color="#963700">180</font><font color="#000000"> ]<br />  [ </font><font color="#0000aa">set</font><font color="#000000"> chemical chemical </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">60</font><font color="#000000">  </font><font color="#5a5a5a">;; drop some chemical</font><font color="#000000"><br />    uphill-nest-scent ]         </font><font color="#5a5a5a">;; head toward the greatest value of nest-scent</font><font color="#000000"><br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> look-for-food  </font><font color="#5a5a5a">;; turtle procedure</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> food </font><font color="#660096">&gt;</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"><br />  [ </font><font color="#0000aa">set</font><font color="#000000"> </font><font color="#660096">color</font><font color="#000000"> </font><font color="#963700">orange</font><font color="#000000"> </font><font color="#660096">+</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">     </font><font color="#5a5a5a">;; pick up food</font><font color="#000000"><br />    </font><font color="#0000aa">set</font><font color="#000000"> food food </font><font color="#660096">-</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000">        </font><font color="#5a5a5a">;; and reduce the food source</font><font color="#000000"><br />    </font><font color="#0000aa">rt</font><font color="#000000"> </font><font color="#963700">180</font><font color="#000000">                   </font><font color="#5a5a5a">;; and turn around</font><font color="#000000"><br />    </font><font color="#0000aa">stop</font><font color="#000000"> ]<br />  </font><font color="#5a5a5a">;; go in the direction where the chemical smell is strongest</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> (chemical </font><font color="#660096">&gt;=</font><font color="#000000"> </font><font color="#963700">0.05</font><font color="#000000">) </font><font color="#660096">and</font><font color="#000000"> (chemical </font><font color="#660096">&lt;</font><font color="#000000"> </font><font color="#963700">2</font><font color="#000000">)<br />  [ uphill-chemical ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; sniff left and right, and go where the strongest smell is</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> uphill-chemical  </font><font color="#5a5a5a">;; turtle procedure</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> scent-ahead chemical-scent-at-angle   </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> scent-right chemical-scent-at-angle  </font><font color="#963700">45</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> scent-left  chemical-scent-at-angle </font><font color="#963700">-45</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> (scent-right </font><font color="#660096">&gt;</font><font color="#000000"> scent-ahead) </font><font color="#660096">or</font><font color="#000000"> (scent-left </font><font color="#660096">&gt;</font><font color="#000000"> scent-ahead)<br />  [ </font><font color="#0000aa">ifelse</font><font color="#000000"> scent-right </font><font color="#660096">&gt;</font><font color="#000000"> scent-left<br />    [ </font><font color="#0000aa">rt</font><font color="#000000"> </font><font color="#963700">45</font><font color="#000000"> ]<br />    [ </font><font color="#0000aa">lt</font><font color="#000000"> </font><font color="#963700">45</font><font color="#000000"> ] ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#5a5a5a">;; sniff left and right, and go where the strongest smell is</font><font color="#000000"><br /></font><font color="#007f69">to</font><font color="#000000"> uphill-nest-scent  </font><font color="#5a5a5a">;; turtle procedure</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> scent-ahead nest-scent-at-angle   </font><font color="#963700">0</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> scent-right nest-scent-at-angle  </font><font color="#963700">45</font><font color="#000000"><br />  </font><font color="#0000aa">let</font><font color="#000000"> scent-left  nest-scent-at-angle </font><font color="#963700">-45</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> (scent-right </font><font color="#660096">&gt;</font><font color="#000000"> scent-ahead) </font><font color="#660096">or</font><font color="#000000"> (scent-left </font><font color="#660096">&gt;</font><font color="#000000"> scent-ahead)<br />  [ </font><font color="#0000aa">ifelse</font><font color="#000000"> scent-right </font><font color="#660096">&gt;</font><font color="#000000"> scent-left<br />    [ </font><font color="#0000aa">rt</font><font color="#000000"> </font><font color="#963700">45</font><font color="#000000"> ]<br />    [ </font><font color="#0000aa">lt</font><font color="#000000"> </font><font color="#963700">45</font><font color="#000000"> ] ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to</font><font color="#000000"> wiggle  </font><font color="#5a5a5a">;; turtle procedure</font><font color="#000000"><br />  </font><font color="#0000aa">rt</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">40</font><font color="#000000"><br />  </font><font color="#0000aa">lt</font><font color="#000000"> </font><font color="#660096">random</font><font color="#000000"> </font><font color="#963700">40</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> </font><font color="#660096">not</font><font color="#000000"> </font><font color="#660096">can-move?</font><font color="#000000"> </font><font color="#963700">1</font><font color="#000000"> [ </font><font color="#0000aa">rt</font><font color="#000000"> </font><font color="#963700">180</font><font color="#000000"> ]<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> nest-scent-at-angle [angle]<br />  </font><font color="#0000aa">let</font><font color="#000000"> p </font><font color="#660096">patch-right-and-ahead</font><font color="#000000"> angle </font><font color="#963700">1</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> p </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [ </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> ]<br />  </font><font color="#0000aa">report</font><font color="#000000"> [nest-scent] </font><font color="#660096">of</font><font color="#000000"> p<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /></font><font color="#007f69">to-report</font><font color="#000000"> chemical-scent-at-angle [angle]<br />  </font><font color="#0000aa">let</font><font color="#000000"> p </font><font color="#660096">patch-right-and-ahead</font><font color="#000000"> angle </font><font color="#963700">1</font><font color="#000000"><br />  </font><font color="#0000aa">if</font><font color="#000000"> p </font><font color="#660096">=</font><font color="#000000"> </font><font color="#963700">nobody</font><font color="#000000"> [ </font><font color="#0000aa">report</font><font color="#000000"> </font><font color="#963700">0</font><font color="#000000"> ]<br />  </font><font color="#0000aa">report</font><font color="#000000"> [chemical] </font><font color="#660096">of</font><font color="#000000"> p<br /></font><font color="#007f69">end</font><font color="#000000"><br /><br /><br /></font><font color="#5a5a5a">; Copyright 1997 Uri Wilensky.</font><font color="#000000"><br /></font><font color="#5a5a5a">; See Info tab for full copyright and license.</font>
</pre>
